---
created: 2025-02-17
tags:
  - Lessons/School/HEH/BlocX/QuadX
---

# # üìö  4.4 - NAT - Pr√©paration au d√©ploiement
> **Cr√©ation de la note √† *`17:27`* le *`2025-02-17`.***
---

## **Partie analyse : pr√©paration du d√©ploiement du pare-feu FortiGate**

### **4.4.1 Analyse des r√®gles de pare-feu n√©cessitant du NAT**

Analyser les r√®gles de pare-feu cr√©√©es pr√©c√©demment et identifier celles qui n√©cessitent une traduction d'adresse r√©seau (NAT) :

- R√®gle 1 : Acc√®s Internet des employ√©s
- R√®gle 2 : Publication d‚Äôun serveur Web en DMZ
- R√®gle 3 : Connexion VPN client-serveur
- R√®gle 4 : Redirection d‚Äôun service SSH vers un serveur interne

### **4.4.2 Type de NAT √† appliquer**

- **R√®gle 1 : SNAT (Source NAT)**
    - But : Permettre aux employ√©s d‚Äôacc√©der √† Internet via une adresse IP publique unique.
- **R√®gle 2 : DNAT (Destination NAT) avec VIP**
    - But : Permettre aux utilisateurs externes d‚Äôacc√©der au serveur Web.
- **R√®gle 3 : Port Forwarding (DNAT sp√©cifique)**
    - But : Rediriger les connexions VPN entrantes vers le serveur VPN interne.
- **R√®gle 4 : Port Forwarding (DNAT sp√©cifique)**
    - But : Permettre l‚Äôacc√®s SSH depuis l‚Äôext√©rieur vers un serveur interne.

### **4.4.3 M√©thode de configuration de la NAT**

- **Policy-Based NAT** pour la r√®gle 1 (SNAT simple via l‚Äôinterface WAN).
- **Central SNAT** pour des besoins plus avanc√©s.
- **Virtual IP (VIP) avec port forwarding** pour les r√®gles 2, 3 et 4.

### **4.4.4 Liste des param√®tres de configuration n√©cessaires**

- **Interface de sortie** : WAN1
- **IP Pool** : 203.0.113.10/29 (plage d‚Äôadresses IP publiques attribu√©es)
- **VIPs** :
    - VIP_Web : 203.0.113.11 ‚Üí 192.168.1.10 (serveur Web)
    - VIP_VPN : 203.0.113.12 ‚Üí 192.168.1.20 (serveur VPN)
    - VIP_SSH : 203.0.113.13:22 ‚Üí 192.168.1.30:22 (serveur SSH)
- **Activation de la Central NAT** : Oui
- **Activation du match-vip enable** : Oui

### **4.4.5 Pr√©paration des valeurs de configuration**

|√âl√©ment|Valeur|
|---|---|
|Interface WAN|WAN1|
|IP publique|203.0.113.10/29|
|VIP Web|203.0.113.11 ‚Üí 192.168.1.10|
|VIP VPN|203.0.113.12 ‚Üí 192.168.1.20|
|VIP SSH|203.0.113.13:22 ‚Üí 192.168.1.30:22|
|Pool SNAT|Automatique (use outgoing IP)|

### **4.4.6 M√©thode de test de la configuration**

- **Test SNAT** : V√©rifier que les employ√©s acc√®dent √† Internet en consultant leur adresse IP publique.
- **Test DNAT pour serveur Web** : Acc√©der au site via l‚Äôadresse publique.
- **Test VPN** : Se connecter au serveur VPN depuis un r√©seau externe.
- **Test SSH** : V√©rifier que la redirection SSH fonctionne.

### **4.4.7 Cr√©ation du script ou des r√®gles NAT**

#### **Exemple de configuration FortiGate (CLI)**

```shell
config firewall vip
  edit "VIP_Web"
    set extip 203.0.113.11
    set mappedip 192.168.1.10
    set portforward enable
    set extport 80
    set mappedport 80
  next
end
```

### **4.4.8 Estimation du temps n√©cessaire √† la mise en ≈ìuvre**

- Configuration NAT : 1 heure
- Tests et validation : 25 minutes

### **4.4.9 Planification de l‚Äôintervention**

- **Pr√©requis** : V√©rifier les acc√®s administratifs au FortiGate, les configurations r√©seaux existantes.
- **Autres configurations pr√©alables** : Validation des routes et des politiques de pare-feu.

### **4.4.10 V√©rification des points m√©thodologiques**

- ‚úÖ Documentation des param√®tres utilis√©s
- ‚úÖ Backup des configurations avant modification
- ‚úÖ Plan de rollback en cas de probl√®me
- ‚úÖ Communication avec les √©quipes impact√©es